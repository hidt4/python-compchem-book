"""高精度エネルギー計算
"""

import psi4

au2kcal = psi4.constants.hartree2kcalmol

high_level = 'mp2/aug-cc-pvtz'

psi4.set_output_file('high_level_single_point.log')

equatorial = psi4.geometry('''
0 1
 C   -0.336905645406   -1.071358284511   -0.668503615247
 C    1.193285529251   -1.083213559334   -0.655705552660
 C    1.767015742405    0.334784444614   -0.641628686212
 C    1.194920054547    1.154460175737    0.516354219630
 C   -0.335275995892    1.159982347225    0.500243322928
 C   -0.921697828513   -0.257677572212    0.493237548436
 H    2.858119393623    0.300824434795   -0.578316230846
 H    1.542402311701   -1.622171771412    0.232717414596
 H    1.571078199664   -1.635298793109   -1.520599767546
 H   -0.687174016806   -0.642514222397   -1.615726570735
 H   -0.718920713448   -2.095958816470   -0.633566093498
 H    1.544124043900    0.730638039488    1.465082216561
 H    1.573861890305    2.179378813480    0.477467789441
 H   -0.716135743358    1.715129127830    1.362635397136
 H   -0.685469604964    1.694851519937   -0.391444098443
 H   -0.614483505794   -0.747006886685    1.427020861110
 H    1.525589768943    0.831146708930   -1.588932132233
 C   -2.448953059156   -0.237995624368    0.457789455947
 H   -2.858573964366   -1.250816405956    0.489226826645
 H   -2.857434576841    0.313301833539    1.308552293687
 H   -2.815177636985    0.240618437032   -0.455391751202
''')

axial = psi4.geometry('''
0 1
 C   -0.599543285462   -0.980802816527   -0.843568635594
 C    0.930382142077   -0.947542055430   -0.917636373153
 C    1.457874855669    0.488881367285   -0.935599768294
 C    0.931966911184    1.292921002247    0.255544857275
 C   -0.597963770013    1.252686351487    0.325960891358
 C   -1.167375361928   -0.177045626520    0.339688017162
 H    2.551390581534    0.490941061830   -0.941013780429
 H    1.359362068346   -1.481122509115   -0.063182862788
 H    1.266671838636   -1.482607530432   -1.810079075202
 H   -1.001474798763   -0.562054274947   -1.773109789146
 H   -0.952230681407   -2.015342504960   -0.795565274027
 H    1.361039518866    0.894100193441    1.180564195104
 H    1.269369755327    2.330836906371    0.186769974396
 H   -0.949534243234    1.802923118932    1.203801351727
 H   -0.999814791807    1.778597990859   -0.547467933613
 H    1.141500811849    0.976109691718   -1.865640956528
 C   -0.959583861438   -0.881795024789    1.685282044342
 H   -1.419766529806   -0.309886456141    2.495240991032
 H   -1.420878467653   -1.872763032472    1.676858835103
 H    0.094551928447   -1.013845673509    1.936027923663
 H   -2.249673818595   -0.099118053326    0.192327934639
''')

eq_energy = psi4.energy(high_level, molecule=equatorial)
ax_energy = psi4.energy(high_level, molecule=axial)

free_energy_eq = eq_energy + 0.17953219845659935
free_energy_ax = ax_energy + 0.17992845779974725

diff_free_energy = (free_energy_ax - free_energy_eq) * au2kcal
print(f'free energy difference at high level: {diff_free_energy: .2f} kcal/mol')