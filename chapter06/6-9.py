"""frozen_cartesianオプション
"""

import psi4

psi4.set_num_threads(14)
psi4.set_memory('20GB')

# ログファイルの設定
psi4.set_output_file('frozen_cartesian.log')

# 構造の定義
urea = psi4.geometry('''
0 1
C  -1.0482368367  -0.0012423218  -0.7758260561
O  -0.0156753108  -0.0009116043  -1.4283127954
N  -1.7018904431   1.1779245825  -0.3361582586
N  -1.7266400660  -1.1964224417  -0.3989998481
H  -2.6423326976   1.1099656587   0.0477575562
H  -2.6243470466  -1.1132273634   0.0768581166
C  -1.0331079014   2.4327891484  -0.2240686746
C  -1.7709147156   3.6047187295  -0.1240375937
C   0.3646086960   2.4973476556  -0.1752142056
C  -1.1050846099   4.8208129312  -0.0180761207
H  -2.8520156513   3.5729985722  -0.1396804543
C   1.0061712280   3.7072816831  -0.0381144239
H   0.9419000890   1.5862284330  -0.2376082475
C   0.2701868058   4.8845111549   0.0085960416
H   0.7715659747   5.8417509737   0.0568813942
C  -1.0357160633  -2.4408328658  -0.2531541833
C  -1.7721762481  -3.6146113788  -0.1538842773
C   0.3585515106  -2.4973265719  -0.1766237776
C  -1.1060839791  -4.8222638807  -0.0202426056
H  -2.8530368758  -3.5848424540  -0.1873777316
C   1.0045107741  -3.7088549649  -0.0250016816
H   0.9322000371  -1.5820970571  -0.2346267401
C   0.2710808092  -4.8842783600   0.0289372341
H   0.7704073129  -5.8416948859   0.0936212507
C   2.5536477648   3.7773576262  -0.0016853817
C  -1.9225668536   6.1368680035  -0.0023114781
C   2.5550174644  -3.7772234847  -0.0001177715
C  -1.9236673895  -6.1367948329   0.0021592828
F  -1.0990604049   7.2059841426  -0.0034260349
F  -2.7134666506   6.1869873422   1.0987995779
F  -2.7140404800   6.1853874684  -1.1034015072
F   2.9670204746   5.0647872239  -0.0000217451
F   3.0409557981   3.1550722476  -1.1003739505
F   3.0396455561   3.1576990486   1.1017473456
F   3.0403564876  -3.1561078437  -1.0998936671
F   3.0397742797  -3.1567134866   1.1024612903
F   2.9667580606  -5.0647949842   0.0019500673
F  -1.0988989956  -7.2058336061   0.0039753596
F  -2.7133083352  -6.1853211090   1.1043007201
F  -2.7137953394  -6.1873520690  -1.0982323098
''')

# 制約条件を設定
conditions = ' '.join([f'{id} XYZ' for id in range(25, 41)])
psi4.set_options({'FROZEN_CARTESIAN': conditions,
                  'GEOM_MAXITER': 100})

# 最適化
print('### Constrained optimization')
print(psi4.p4util.prepare_options_for_set_options())
psi4.optimize('hf/sto-3g', molecule=urea)
print(urea.save_string_xyz())

print('### Clear constraints')
psi4.core.clean_options()
print(psi4.p4util.prepare_options_for_set_options())
psi4.optimize('hf/sto-3g', molecule=urea)
print(urea.save_string_xyz())

# _, wfn = psi4.frequency('hf/sto-3g', molecule=urea, return_wfn=True)
# print(wfn.frequencies().to_array())
